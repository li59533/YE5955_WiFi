# 无线温振传感器W100\_交互协议\_20200211
## 1.采用协议
LN私有协议 + 上报私有协议 
###  1.1 协议格式
**LN协议格式**
```
// head len cmd tlv foot sum
typedef struct
{
    uint8_t head;
    uint16_t len;
    uint16_t inf
    uint8_t cmd;
    uint8_t * payload;
    uint8_t foot;
    uint8_t sum;
}LN_Protocol_t
```
### 1.2协议说明
​	**LN 协议**
* head ： 协议头部，为固定标识
* len :从head到sum的长度
* Inf:预留，用于兼容点对点、1对多、ACK等用途
* cmd：当前报文所属命令
* payload：当前cmd所包含的负载内容
* foot: 协议尾部，为固定标识
* sum:校验和，从head到foot

## 2.命令说明
### 2.1 压路机支持命令
|序号|cmd|说明|名称|
|---|---|---|---|
|1|0x01|设置配置参数 请求|CMD_SetConf_Req|
|2|0x02|设置配置参数 应答|CMD_SetConf_Resp|
|3|0x03|获取配置参数 请求|CMD_GetConf_Req|
|4|0x04|获取配置参数 应答|CMD_GetConf_Resp|
|5|0x80|获取软件版本 请求|CMD_GetVersion_Req|
|6|0x81|获取软件版本 应答|CMD_GetVersion_Resp|
|      |      |                   |                     |
|      |      |                   |                     |


### 2.2 CMD说明

#### 2.2.1 设置配置参数
**请求**：CMD-> CMD_SetConf_Req (0x01)
**Payload **：TLV
协议如下：

|序号|Tag|Len|Value|说明|
|---|---|---|---|---|
|1|0x01|1||工作模式：0x00 ->正常模式、0x01->低功耗模式、0x02->测试模式|
|2|      |      |       |                                                             |
|3|||||
||||||
**应答**
无

#### 2.2.2 获取配置参数

**请求**：CMD->CMD_GetConf_Req(0x03)
**Payload **：

无

**应答**
**Payload **：TLV
协议如下：

|序号|Tag|Len|Value|说明|
|---|---|---|---|---|
|1|0x01|1||工作模式：0x00 ->正常模式、0x01->低功耗模式、0x02->测试模式|
| 2    |      |      |       |                                                             |
|3|||||
||||||
#### 2.2.3 获取软件版本
**请求**：CMD->CMD_GetVersion_Req(0x80)
**Payload **：

无

**应答**
**Payload**:

```
typedef struct
{
    uint32_t version;
}Payload_t
```

uint32_t 为小端

0x00010203 为1.2.3版本

#### 2.2.4 获取数据
**请求**：CMD->CMD_GetValue_Req(0xD0)
**Payload **：

无

**应答**
**上报私有协议**:type:0x42








